<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cwjcsu.ybjj.mapper.UserMapper" >
  <resultMap id="BaseResultMap" type="com.cwjcsu.ybjj.domain.User" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" property="id" jdbcType="INTEGER" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="nickname" property="nickname" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="avatar" property="avatar" jdbcType="VARCHAR" />
    <result column="gender" property="gender" jdbcType="TINYINT" />
    <result column="user_status" property="userStatus" jdbcType="TINYINT" />
    <result column="online" property="online" jdbcType="BIT" />
    <result column="user_type" property="userType" jdbcType="TINYINT" />
    <result column="signature" property="signature" jdbcType="VARCHAR" />
    <result column="company" property="company" jdbcType="VARCHAR" />
    <result column="phone" property="phone" jdbcType="VARCHAR" />
    <result column="email" property="email" jdbcType="VARCHAR" />
    <result column="location" property="location" jdbcType="VARCHAR" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from users
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.cwjcsu.ybjj.domain.User" useGeneratedKeys="true" keyProperty="id" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into users (name, nickname, create_time, 
      avatar, gender, user_status, 
      online, user_type, signature, 
      company, phone, email, 
      location)
    values (#{name,jdbcType=VARCHAR}, #{nickname,jdbcType=VARCHAR}, #{createTime,jdbcType=TIMESTAMP}, 
      #{avatar,jdbcType=VARCHAR}, #{gender,jdbcType=TINYINT}, #{userStatus,jdbcType=TINYINT}, 
      #{online,jdbcType=BIT}, #{userType,jdbcType=TINYINT}, #{signature,jdbcType=VARCHAR}, 
      #{company,jdbcType=VARCHAR}, #{phone,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR}, 
      #{location,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.cwjcsu.ybjj.domain.User" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update users
    set name = #{name,jdbcType=VARCHAR},
      nickname = #{nickname,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=TIMESTAMP},
      avatar = #{avatar,jdbcType=VARCHAR},
      gender = #{gender,jdbcType=TINYINT},
      user_status = #{userStatus,jdbcType=TINYINT},
      online = #{online,jdbcType=BIT},
      user_type = #{userType,jdbcType=TINYINT},
      signature = #{signature,jdbcType=VARCHAR},
      company = #{company,jdbcType=VARCHAR},
      phone = #{phone,jdbcType=VARCHAR},
      email = #{email,jdbcType=VARCHAR},
      location = #{location,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select id, name, nickname, create_time, avatar, gender, user_status, online, user_type, 
    signature, company, phone, email, location
    from users
    where id = #{id,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select id, name, nickname, create_time, avatar, gender, user_status, online, user_type, 
    signature, company, phone, email, location
    from users
  </select>
  <update id="updateOnlineStautsById">
    UPDATE users SET online = #{online} WHERE id = #{userId}
  </update>
  <select id="selectByNameOrEmailOrPhone" resultType="com.cwjcsu.ybjj.domain.User">
    select id, name, nickname, create_time, avatar, gender,
    user_status, online, user_type, company,phone, email
    from users
    where name = #{name} or email = #{name} or phone = #{name}
  </select>
  <select id="selectByPhone" resultType="com.cwjcsu.ybjj.domain.User">
    select id, name, nickname, create_time, avatar, gender,
    user_status, online, user_type, company,email,phone
    from users
    where phone = #{phone}
  </select>
  <select id="selectByEmail" resultType="com.cwjcsu.ybjj.domain.User">
    select id, name, nickname, create_time, avatar, gender,
    user_status, online, user_type, company,email,phone
    from users
    where email = #{email}
  </select>

  <select id="selectByOpenId" resultType="com.cwjcsu.ybjj.domain.User">
    select u.id, u.name, u.nickname, u.create_time, u.avatar, u.gender,
    u.user_status, u.online, u.user_type, u.company,u.email,u.phone
    from users u inner join open_account a on u.id = a.user_id
    where a.oauth_type=#{oauthType} and  a.open_id=#{openId}  order by u.id desc limit 0,1;
  </select>
</mapper>